<!doctype html><html lang=zh-tw><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>NET Core MVC 入門操作筆記 - 程式狂想筆記 - 記錄著我接觸程式藝文</title><meta name=Description content="記錄著我接觸程式藝文"><meta property="og:title" content="NET Core MVC 入門操作筆記"><meta property="og:description" content="這邊使用 .Net Core 5 版本，Net Core 6 會不太一樣，大致原理都是一致的。這邊我觀看學習教學影片邊紀錄，我覺得動手做比較容易了解問題與忽略問題地方，我那個影片有操作一些錯誤地方，不是他忘記步驟，而是當我們忘記那些步驟可以快速從那個地方找出問題解決。"><meta property="og:type" content="article"><meta property="og:url" content="https://malagege.github.io/blog/posts/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-01T18:15:44+08:00"><meta property="article:modified_time" content="2022-12-01T18:15:44+08:00"><meta property="og:site_name" content="程式狂想筆記"><meta name=twitter:card content="summary"><meta name=twitter:title content="NET Core MVC 入門操作筆記"><meta name=twitter:description content="這邊使用 .Net Core 5 版本，Net Core 6 會不太一樣，大致原理都是一致的。這邊我觀看學習教學影片邊紀錄，我覺得動手做比較容易了解問題與忽略問題地方，我那個影片有操作一些錯誤地方，不是他忘記步驟，而是當我們忘記那些步驟可以快速從那個地方找出問題解決。"><meta name=application-name content="程式狂想筆記"><meta name=apple-mobile-web-app-title content="程式狂想筆記"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://malagege.github.io/blog/posts/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98/><link rel=prev href=https://malagege.github.io/blog/posts/Net-Core-%E5%89%B5%E5%BB%BA%E5%B0%88%E6%A1%88/><link rel=next href=https://malagege.github.io/blog/posts/Net-Core-Image-Helper-%E8%A7%A3%E6%B1%BA%E5%9C%96%E7%89%87-img-%E7%B7%A9%E5%AD%98%E5%95%8F%E9%A1%8C/><link rel=stylesheet href=/blog/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"NET Core MVC 入門操作筆記","inLanguage":"zh-tw","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/malagege.github.io\/blog\/posts\/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98\/"},"genre":"posts","keywords":"di, mvc, net core, api, controller, view, repository","wordcount":2498,"url":"https:\/\/malagege.github.io\/blog\/posts\/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98\/","datePublished":"2022-12-01T18:15:44+08:00","dateModified":"2022-12-01T18:15:44+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"malagege"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/blog/ title="程式狂想筆記 - 記錄著我接觸程式藝文">程式狂想筆記</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/blog/>首頁 </a><a class=menu-item href=/blog/posts/>文章 </a><a class=menu-item href=/blog/tags/>標籤 </a><a class=menu-item href=/blog/categories/>分類 </a><a class=menu-item href=/blog/links/ title=覺得不錯好站都會放在這邊>好站連結 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/blog/ title="程式狂想筆記 - 記錄著我接觸程式藝文">程式狂想筆記</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/blog/ title>首頁</a><a class=menu-item href=/blog/posts/ title>文章</a><a class=menu-item href=/blog/tags/ title>標籤</a><a class=menu-item href=/blog/categories/ title>分類</a><a class=menu-item href=/blog/links/ title=覺得不錯好站都會放在這邊>好站連結</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div><div align=center><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1439458814178865" crossorigin=anonymous></script>
<ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-1439458814178865 data-ad-slot=2236653478></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">NET Core MVC 入門操作筆記</h1><div align=center><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1439458814178865" crossorigin=anonymous></script>
<ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-1439458814178865 data-ad-slot=2236653478></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/blog/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>malagege</a></span>&nbsp;<span class=post-category>included in <a href=/blog/categories/Net-Core/><i class="far fa-folder fa-fw" aria-hidden=true></i>Net Core</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-12-01>2022-12-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2498 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;12 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://user-images.githubusercontent.com/6058558/205041867-93ffe0d5-60e8-4d96-b2dd-40328554913a.png data-srcset="https://user-images.githubusercontent.com/6058558/205041867-93ffe0d5-60e8-4d96-b2dd-40328554913a.png, https://user-images.githubusercontent.com/6058558/205041867-93ffe0d5-60e8-4d96-b2dd-40328554913a.png 1.5x, https://user-images.githubusercontent.com/6058558/205041867-93ffe0d5-60e8-4d96-b2dd-40328554913a.png 2x" data-sizes=auto alt=https://user-images.githubusercontent.com/6058558/205041867-93ffe0d5-60e8-4d96-b2dd-40328554913a.png title=https://user-images.githubusercontent.com/6058558/205041867-93ffe0d5-60e8-4d96-b2dd-40328554913a.png></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#專案選擇>專案選擇</a></li><li><a href=#startupcs>Startup.cs</a></li><li><a href=#net-core-加入-net-core-mvc-中間件>.NET Core 加入 Net Core MVC 中間件</a><ul><li><a href=#mvc-加入到-aspnet-core-依賴注入容器中>MVC 加入到 asp.net core 依賴注入容器中</a></li><li><a href=#設定中間件>設定中間件</a></li></ul></li><li><a href=#addmvc-和-addmvccore>addMvc 和 addMvcCore</a></li><li><a href=#建立-controller>建立 Controller</a></li><li><a href=#新增-model>新增 Model</a></li><li><a href=#建立-repository>建立 Repository</a></li><li><a href=#建立-mockrepository>建立 MockRepository</a></li><li><a href=#controller-依賴注入-dogrepository>Controller 依賴注入 DogRepository</a></li><li><a href=#依賴注入>依賴注入</a><ul><li><a href=#依賴注入種類>依賴注入種類</a></li><li><a href=#優點>優點</a></li></ul></li><li><a href=#controller-json-範例>Controller JSON 範例</a><ul><li><a href=#看-http-協議傳回格式>看 HTTP 協議傳回格式</a></li></ul></li><li><a href=#view>View</a><ul><li><a href=#net-core-5-建立檢視失敗可以參考參考>.Net Core 5 建立檢視失敗可以參考(參考)</a></li></ul></li><li><a href=#自訂義-view-發現>自訂義 View 發現</a></li><li><a href=#controller-傳遞資料到-view>Controller 傳遞資料到 View</a><ul><li><a href=#viewdata>ViewData</a></li><li><a href=#viewbag>ViewBag</a></li><li><a href=#強型別view>強型別View</a></li></ul></li><li><a href=#viewmodel-視圖模型>ViewModel 視圖模型</a></li><li><a href=#實現-list-視圖>實現 List 視圖</a></li><li><a href=#net-core-mvc-部局視圖>.NET Core MVC 部局視圖</a></li><li><a href=#布局頁面的結點sections>布局頁面的結點(Sections)</a></li><li><a href=#_viewstartcshtml>_ViewStart.cshtml</a></li><li><a href=#_viewimportcshtml>_ViewImport.cshtml</a></li><li><a href=#路由route>路由(Route)</a></li><li><a href=#屬性路由>屬性路由</a><ul><li><a href=#controller-跟-router-命名不一樣>Controller 跟 Router 命名不一樣</a></li></ul></li><li><a href=#route-放置-controller-上面>Route 放置 Controller 上面</a><ul><li><a href=#在自動調整方法>在自動調整方法</a></li><li><a href=#實戰中還是用>實戰中還是用&mldr;</a></li></ul></li><li><a href=#總結>總結</a></li></ul></nav></div></div><div class=content id=content><p>這邊使用 .Net Core 5 版本，Net Core 6 會不太一樣，大致原理都是一致的。這邊我觀看學習教學影片邊紀錄，我覺得動手做比較容易了解問題與忽略問題地方，我那個影片有操作一些錯誤地方，不是他忘記步驟，而是當我們忘記那些步驟可以快速從那個地方找出問題解決。</p><h2 id=專案選擇>專案選擇</h2><p>這邊要選擇 Web API 選項。</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/v71u5H7.png data-srcset="https://i.imgur.com/v71u5H7.png, https://i.imgur.com/v71u5H7.png 1.5x, https://i.imgur.com/v71u5H7.png 2x" data-sizes=auto alt=https://i.imgur.com/v71u5H7.png title=https://i.imgur.com/v71u5H7.png></p><h2 id=startupcs>Startup.cs</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>Startup</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>Startup</span><span class=p>(</span><span class=n>IConfiguration</span> <span class=n>configuration</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Configuration</span> <span class=p>=</span> <span class=n>configuration</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IConfiguration</span> <span class=n>Configuration</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// This method gets called by the runtime. Use this method to add services to the container.</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>ConfigureServices</span><span class=p>(</span><span class=n>IServiceCollection</span> <span class=n>services</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddControllers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddSwaggerGen</span><span class=p>(</span><span class=n>c</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>c</span><span class=p>.</span><span class=n>SwaggerDoc</span><span class=p>(</span><span class=s>&#34;v1&#34;</span><span class=p>,</span> <span class=k>new</span> <span class=n>OpenApiInfo</span> <span class=p>{</span> <span class=n>Title</span> <span class=p>=</span> <span class=s>&#34;WebApplication6&#34;</span><span class=p>,</span> <span class=n>Version</span> <span class=p>=</span> <span class=s>&#34;v1&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>Configure</span><span class=p>(</span><span class=n>IApplicationBuilder</span> <span class=n>app</span><span class=p>,</span> <span class=n>IWebHostEnvironment</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>env</span><span class=p>.</span><span class=n>IsDevelopment</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>app</span><span class=p>.</span><span class=n>UseDeveloperExceptionPage</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>app</span><span class=p>.</span><span class=n>UseSwagger</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                <span class=n>app</span><span class=p>.</span><span class=n>UseSwaggerUI</span><span class=p>(</span><span class=n>c</span> <span class=p>=&gt;</span> <span class=n>c</span><span class=p>.</span><span class=n>SwaggerEndpoint</span><span class=p>(</span><span class=s>&#34;/swagger/v1/swagger.json&#34;</span><span class=p>,</span> <span class=s>&#34;WebApplication6 v1&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseHttpsRedirection</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseRouting</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseAuthorization</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseEndpoints</span><span class=p>(</span><span class=n>endpoints</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>endpoints</span><span class=p>.</span><span class=n>MapControllers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>程式上面重點:</p><ol><li>Configure 註冊容器服務，會在這邊配置訊息。</li><li>ConfigureServices 依賴注入服務都會在這邊設定。</li></ol><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>Tip<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>這邊可以看到 <code>Startup()</code> 注入了 IConfiguration，這邊我後續讀完覺得很奇怪，<code>ConfigureServices()</code> 這邊不是才註冊容器嗎?為什麼建構子就能注入，剛好查看官方文件原來能注入東西很少。</p><blockquote><p>使用泛型主機 () IHostBuilder 時，只能將下列服務類型插入 Startup 建構函式：</p><p>IWebHostEnvironment<br>IHostEnvironment<br>IConfiguration</p></blockquote><p>相關連結: <a href="https://learn.microsoft.com/zh-tw/aspnet/core/fundamentals/startup?view=aspnetcore-5.0#:~:text=%E4%BD%BF%E7%94%A8%E6%B3%9B%E5%9E%8B%E4%B8%BB%E6%A9%9F%20%28%29%20IHostBuilder%20%E6%99%82%EF%BC%8C%E5%8F%AA%E8%83%BD%E5%B0%87%E4%B8%8B%E5%88%97%E6%9C%8D%E5%8B%99%E9%A1%9E%E5%9E%8B%E6%8F%92%E5%85%A5%20Startup%20%E5%BB%BA%E6%A7%8B%E5%87%BD%E5%BC%8F%EF%BC%9A" target=_blank rel="noopener noreffer">點我</a></p></div></div></div><h2 id=net-core-加入-net-core-mvc-中間件>.NET Core 加入 Net Core MVC 中間件</h2><p>這邊提一下中間件英文是<code>MIddleware</code>。</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>Tip<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>這邊我在學習 Middleware 我發現跟 Laravel Middleware 很像，回想我當初學的 Spring Boot 沒有這一層東西，但一樣還是可以做到這一層事情。沒錯，是 AOP。所以Spring Boot 不需要有 Middleware 這一個東西。</p><p>相關連結: <a href=http://malagege.github.io/blog/posts/Spring-Boot-AOP-%E5%B0%8F%E8%A8%98/ target=_blank rel="noopener noreffer">Spring Boot AOP 小記</a></p></div></div></div><h3 id=mvc-加入到-aspnet-core-依賴注入容器中>MVC 加入到 asp.net core 依賴注入容器中</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>ConfigureServices</span><span class=p>(</span><span class=n>IServiceCollection</span> <span class=n>services</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddMvc</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>但是新版，上面可能要做變更，參考<a href="https://docs.microsoft.com/zh-tw/aspnet/core/migration/22-to-30?view=aspnetcore-6.0&tabs=visual-studio#use-mvc-without-endpoint-routing" target=_blank rel="noopener noreffer">從 ASP.NET Core 2.2 移轉至 3.0 | Microsoft Docs</a>文章。</p><p>這邊我用 .Net Core 5</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>ConfigureServices</span><span class=p>(</span><span class=n>IServiceCollection</span> <span class=n>services</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddMvc</span><span class=p>(</span><span class=n>options</span> <span class=p>=&gt;</span> <span class=n>options</span><span class=p>.</span><span class=n>EnableEndpointRouting</span> <span class=p>=</span> <span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=設定中間件>設定中間件</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>Configure</span><span class=p>(</span><span class=n>IApplicationBuilder</span> <span class=n>app</span><span class=p>,</span> <span class=n>IWebHostEnvironment</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>env</span><span class=p>.</span><span class=n>IsDevelopment</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>app</span><span class=p>.</span><span class=n>UseDeveloperExceptionPage</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>app</span><span class=p>.</span><span class=n>UseExceptionHandler</span><span class=p>(</span><span class=s>&#34;/Error&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseStaticFiles</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseMvcWithDefaultRoute</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>Run</span><span class=p>(</span><span class=k>async</span> <span class=p>(</span><span class=n>context</span><span class=p>)</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>await</span> <span class=n>context</span><span class=p>.</span><span class=n>Response</span><span class=p>.</span><span class=n>WriteAsync</span><span class=p>(</span><span class=s>&#34;Hello world&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p><a href="https://docs.microsoft.com/zh-tw/aspnet/core/migration/22-to-30?view=aspnetcore-6.0&tabs=visual-studio#use-mvc-without-endpoint-routing" target=_blank rel="noopener noreffer">從 ASP.NET Core 2.2 移轉至 3.0 | Microsoft Docs</a></p><h2 id=addmvc-和-addmvccore>addMvc 和 addMvcCore</h2><p>addMvcCore: 只包含MVC功能。所以Controller 用到JSON 回傳會錯誤。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>ConfigureServices</span><span class=p>(</span><span class=n>IServiceCollection</span> <span class=n>services</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddMvc</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>addMvc: 包含MVC Core和相關第三方常用服務方法。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>ConfigureServices</span><span class=p>(</span><span class=n>IServiceCollection</span> <span class=n>services</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddMvcCore</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>簡單說，<code>addMvc</code>中間件比<code>addMvcCore</code>中間件功能還多，這邊剛入門的可以先不用太在意這邊。我後面有篇筆記有紀錄這兩種不太一樣東西。</p><h2 id=建立-controller>建立 Controller</h2><p>在專案建立 <code>Controllers</code>，建立<code>HomeController</code></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/RVUiNia.png data-srcset="https://i.imgur.com/RVUiNia.png, https://i.imgur.com/RVUiNia.png 1.5x, https://i.imgur.com/RVUiNia.png 2x" data-sizes=auto alt=https://i.imgur.com/RVUiNia.png title=https://i.imgur.com/RVUiNia.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/WiJTYZF.png data-srcset="https://i.imgur.com/WiJTYZF.png, https://i.imgur.com/WiJTYZF.png 1.5x, https://i.imgur.com/WiJTYZF.png 2x" data-sizes=auto alt=https://i.imgur.com/WiJTYZF.png title=https://i.imgur.com/WiJTYZF.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/c9H1XMv.png data-srcset="https://i.imgur.com/c9H1XMv.png, https://i.imgur.com/c9H1XMv.png 1.5x, https://i.imgur.com/c9H1XMv.png 2x" data-sizes=auto alt=https://i.imgur.com/c9H1XMv.png title=https://i.imgur.com/c9H1XMv.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/A86pKvF.png data-srcset="https://i.imgur.com/A86pKvF.png, https://i.imgur.com/A86pKvF.png 1.5x, https://i.imgur.com/A86pKvF.png 2x" data-sizes=auto alt=https://i.imgur.com/A86pKvF.png title=https://i.imgur.com/A86pKvF.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Controllers</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>HomeController</span> <span class=p>:</span> <span class=n>Controller</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Json</span><span class=p>(</span><span class=k>new</span> <span class=p>{</span> <span class=n>a</span> <span class=p>=</span> <span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=n>b</span> <span class=p>=</span> <span class=s>&#34;2&#34;</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>所有 API 可以回傳 <code>IActionResult</code>，這邊其實有很多物件繼承這個。他可以針對不同類型去做回傳。我網路上有找到繼承圖片。</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/gdDWFWC.png data-srcset="https://i.imgur.com/gdDWFWC.png, https://i.imgur.com/gdDWFWC.png 1.5x, https://i.imgur.com/gdDWFWC.png 2x" data-sizes=auto alt=https://i.imgur.com/gdDWFWC.png title=https://i.imgur.com/gdDWFWC.png><br>參考:<a href=https://blog.georgekosmidis.net/action-results-in-asp-net-core-apis.html target=_blank rel="noopener noreffer">Action results in ASP.NET CORE APIs</a></p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>Tip<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>我目前工作常用到的有<code>IActionResult</code>、<code>IJSONResult</code>、<code>FileResult</code>等等。這邊你可以寫的很死，也可以放你新增的類別也可以，我目前我的專案是這樣用，當人也可以這樣寫<code>ActionResult&lt;你的Class></code>，但我目前不知道直接這樣寫的好處?跟強制直接寫<code>你的Class</code>這樣的好處在哪?</div></div></div><div class="details admonition question open"><div class="details-summary admonition-title"><i class="icon fas fa-question-circle fa-fw" aria-hidden=true></i>Question<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/7lSBqJ7.png data-srcset="https://i.imgur.com/7lSBqJ7.png, https://i.imgur.com/7lSBqJ7.png 1.5x, https://i.imgur.com/7lSBqJ7.png 2x" data-sizes=auto alt=https://i.imgur.com/7lSBqJ7.png title=https://i.imgur.com/7lSBqJ7.png><br>這樣編譯不會錯，這讓我很好奇。有空再整理筆記</div></div></div><h2 id=新增-model>新增 Model</h2><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/VtcIT42.png data-srcset="https://i.imgur.com/VtcIT42.png, https://i.imgur.com/VtcIT42.png 1.5x, https://i.imgur.com/VtcIT42.png 2x" data-sizes=auto alt=https://i.imgur.com/VtcIT42.png title=https://i.imgur.com/VtcIT42.png></p><p>新增Dog.cs。</p><p>在<code>public class</code>上面打<code>///</code>按 Enter，這邊可以得到下面結果。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Models</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// 狗的測試模型</span>
</span></span><span class=line><span class=cl>    <span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>Dog</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>在<code>public class Dog</code>裡面打上<code>prop</code>按下<code>兩下Tab</code>，可以快速設定屬性<code>setter,getter</code>。</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/F5USq25.png data-srcset="https://i.imgur.com/F5USq25.png, https://i.imgur.com/F5USq25.png 1.5x, https://i.imgur.com/F5USq25.png 2x" data-sizes=auto alt=https://i.imgur.com/F5USq25.png title=https://i.imgur.com/F5USq25.png></p><h2 id=建立-repository>建立 Repository</h2><p>這邊選擇介面。</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/fjcN4YN.png data-srcset="https://i.imgur.com/fjcN4YN.png, https://i.imgur.com/fjcN4YN.png 1.5x, https://i.imgur.com/fjcN4YN.png 2x" data-sizes=auto alt=https://i.imgur.com/fjcN4YN.png title=https://i.imgur.com/fjcN4YN.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Models</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>interface</span> <span class=nc>IDogRepository</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>Dog</span> <span class=n>getDog</span><span class=p>(</span><span class=kt>int</span> <span class=n>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=建立-mockrepository>建立 MockRepository</h2><p>可用 <code>ctor</code>按下 tab 快速建立<code>MockDogRepository</code>建構函示，可以參考:<a href="https://docs.microsoft.com/zh-tw/visualstudio/ide/visual-csharp-code-snippets?view=vs-2022" target=_blank rel="noopener noreffer">C# 程式碼片段 - Visual Studio (Windows) | Microsoft Docs</a>文章。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Collections.Generic</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Models</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>MockDogRepository</span> <span class=p>:</span> <span class=n>IDogRepository</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>Dog</span><span class=p>&gt;</span> <span class=n>_dogList</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>MockDogRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>Dog</span> <span class=n>getDog</span><span class=p>(</span><span class=kt>int</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>NotImplementedException</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>最後再補上 Mock 資料。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Collections.Generic</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Models</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>MockDogRepository</span> <span class=p>:</span> <span class=n>IDogRepository</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>Dog</span><span class=p>&gt;</span> <span class=n>_dogList</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>MockDogRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogList</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>Dog</span><span class=p>&gt;()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Dog</span><span class=p>(){</span><span class=n>Id</span><span class=p>=</span><span class=m>1</span><span class=p>,</span><span class=n>Name</span> <span class=p>=</span><span class=s>&#34;dog1&#34;</span><span class=p>,</span><span class=n>Address</span><span class=p>=</span><span class=s>&#34;tw&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Dog</span><span class=p>(){</span><span class=n>Id</span><span class=p>=</span><span class=m>2</span><span class=p>,</span><span class=n>Name</span> <span class=p>=</span><span class=s>&#34;dog2&#34;</span><span class=p>,</span><span class=n>Address</span><span class=p>=</span><span class=s>&#34;tw&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Dog</span><span class=p>(){</span><span class=n>Id</span><span class=p>=</span><span class=m>3</span><span class=p>,</span><span class=n>Name</span> <span class=p>=</span><span class=s>&#34;dog3&#34;</span><span class=p>,</span><span class=n>Address</span><span class=p>=</span><span class=s>&#34;tw&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>Dog</span> <span class=n>getDog</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>NotImplementedException</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=controller-依賴注入-dogrepository>Controller 依賴注入 DogRepository</h2><p>依賴注入這邊跟 Laravel 很像，要完成下面動作做注入。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>private</span> <span class=k>readonly</span> <span class=n>IDogRepository</span> <span class=n>_dogRepostory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>HomeController</span><span class=p>(</span><span class=n>IDogRepository</span> <span class=n>dogRepository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogRepostory</span> <span class=p>=</span> <span class=n>dogRepository</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Controllers</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>HomeController</span> <span class=p>:</span> <span class=n>Controller</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=k>readonly</span> <span class=n>IDogRepository</span> <span class=n>_dogRepostory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>HomeController</span><span class=p>(</span><span class=n>IDogRepository</span> <span class=n>dogRepository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogRepostory</span> <span class=p>=</span> <span class=n>dogRepository</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=kt>string</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>).</span><span class=n>Name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=c1>// return Json(new { a = &#34;1&#34;, b = &#34;2&#34; });</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>http://localhost:46201/home/index</p><div class="details admonition question open"><div class="details-summary admonition-title"><i class="icon fas fa-question-circle fa-fw" aria-hidden=true></i>程式運行發生錯誤<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/HLxq4rt.png data-srcset="https://i.imgur.com/HLxq4rt.png, https://i.imgur.com/HLxq4rt.png 1.5x, https://i.imgur.com/HLxq4rt.png 2x" data-sizes=auto alt=https://i.imgur.com/HLxq4rt.png title=https://i.imgur.com/HLxq4rt.png></p><p>這邊不用太擔心，這邊是註冊容器，沒辦法入住DI。</p></div></div></div><h2 id=依賴注入>依賴注入</h2><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>Tip<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>假如你有學過 Spring Boot 和 Laravel 的話應該對這個算滿熟悉。想當初我學 Laravel 第一次碰注入(DI)這個玩意也是看不太懂。這個有點跟類別<code>static</code>有點像，不需要再<code>new</code>出來。</p><p>首先你可能要知道依賴注入是要如何註冊的，Spring 依賴注入可以看我之前寫過<a href=https://malagege.github.io/blog/posts/%E6%89%8B%E5%8B%95%E9%85%8D%E7%BD%AE-XML-%E6%B3%A8%E5%85%A5-Bean-%E6%96%B9%E6%B3%95/ target=_blank rel="noopener noreffer">這篇</a>，因為Laravel 注入還沒學會，所以就沒深入他怎麼註冊的。回到重點，Net Core 依賴注入只有一種方法，都要去手動註冊，內鍵沒有自動注入，但使用第三方套件也能做到。</p></div></div></div><div class="details admonition warning"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fw" aria-hidden=true></i>Warning<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><blockquote><p>這個有點跟類別<code>static</code>有點像，不需要再<code>new</code>出來。</p></blockquote><p>在使用上可能要了解注入物件的生命週期，通常 Scope 有分幾類，這個有時候會影響程式結果，比較常都用<code>單例模式</code>。這邊我工作上面很多都把這個當全域變數用，我覺得<code>Helper</code>相關類的可以用 <code>static</code>，但其實有些可以做到 <code>static</code>，像是 JWT 加密就可以直接用。</p><p>但有些會吃<code>IConfiguration</code>可以考慮用一個 Service 出來，把設定用上去，再把 <code>Service</code>注入<code>IConfiguration</code>再引用<code>static Helper</code>執行，這樣做程式分層架構可以更好去模組化。但這樣要寫很多類別，很多人都不會這樣做樣子&mldr;</p></div></div></div><p>startup.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>       <span class=k>public</span> <span class=k>void</span> <span class=n>ConfigureServices</span><span class=p>(</span><span class=n>IServiceCollection</span> <span class=n>services</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddMvc</span><span class=p>(</span><span class=n>options</span> <span class=p>=&gt;</span> <span class=n>options</span><span class=p>.</span><span class=n>EnableEndpointRouting</span> <span class=p>=</span> <span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddSingleton</span><span class=p>&lt;</span><span class=n>IDogRepository</span><span class=p>,</span> <span class=n>MockDogRepository</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>實作單例模式，才能正常運作。</p><p>http://localhost:46201/home/index<br><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/UzJd2Z4.png data-srcset="https://i.imgur.com/UzJd2Z4.png, https://i.imgur.com/UzJd2Z4.png 1.5x, https://i.imgur.com/UzJd2Z4.png 2x" data-sizes=auto alt=https://i.imgur.com/UzJd2Z4.png title=https://i.imgur.com/UzJd2Z4.png></p><h3 id=依賴注入種類>依賴注入種類</h3><ul><li>AddSingleton()</li><li>AddTransient()</li><li>AddScoped()</li></ul><h3 id=優點>優點</h3><ul><li>低耦合</li><li>提供了高測試姓，使用測試單元更加容易。</li></ul><h2 id=controller-json-範例>Controller JSON 範例</h2><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/m88IM8U.png data-srcset="https://i.imgur.com/m88IM8U.png, https://i.imgur.com/m88IM8U.png 1.5x, https://i.imgur.com/m88IM8U.png 2x" data-sizes=auto alt=https://i.imgur.com/m88IM8U.png title=https://i.imgur.com/m88IM8U.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Controllers</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>HomeController</span> <span class=p>:</span> <span class=n>Controller</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=k>readonly</span> <span class=n>IDogRepository</span> <span class=n>_dogRepostory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>HomeController</span><span class=p>(</span><span class=n>IDogRepository</span> <span class=n>dogRepository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogRepostory</span> <span class=p>=</span> <span class=n>dogRepository</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=kt>string</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>).</span><span class=n>Name</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=c1>// return Json(new { a = &#34;1&#34;, b = &#34;2&#34; });</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>JsonResult</span> <span class=n>Details</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Dog</span> <span class=n>dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Json</span><span class=p>(</span><span class=n>dog</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=看-http-協議傳回格式>看 HTTP 協議傳回格式</h3><p>ObjectResult</p><p>startup.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>ConfigureServices</span><span class=p>(</span><span class=n>IServiceCollection</span> <span class=n>services</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddMvc</span><span class=p>(</span><span class=n>options</span> <span class=p>=&gt;</span> <span class=n>options</span><span class=p>.</span><span class=n>EnableEndpointRouting</span> <span class=p>=</span> <span class=k>false</span><span class=p>).</span><span class=n>AddXmlSerializerFormatters</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>services</span><span class=p>.</span><span class=n>AddSingleton</span><span class=p>&lt;</span><span class=n>IDogRepository</span><span class=p>,</span> <span class=n>MockDogRepository</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>HomeControler.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=n>ObjectResult</span> <span class=n>Details</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Dog</span> <span class=n>dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=k>new</span> <span class=n>ObjectResult</span><span class=p>(</span><span class=n>dog</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/v7IslV5.png data-srcset="https://i.imgur.com/v7IslV5.png, https://i.imgur.com/v7IslV5.png 1.5x, https://i.imgur.com/v7IslV5.png 2x" data-sizes=auto alt=https://i.imgur.com/v7IslV5.png title=https://i.imgur.com/v7IslV5.png></p><h2 id=view>View</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Dog</span> <span class=n>dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>dog</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/KAJYKoC.png data-srcset="https://i.imgur.com/KAJYKoC.png, https://i.imgur.com/KAJYKoC.png 1.5x, https://i.imgur.com/KAJYKoC.png 2x" data-sizes=auto alt=https://i.imgur.com/KAJYKoC.png title=https://i.imgur.com/KAJYKoC.png></p><p>這個錯誤會顯示默認 VIEW 三個路徑</p><ul><li>/Views/Home/Details.cshtml</li><li>/Views/Shared/Details.cshtml</li><li>/Pages/Shared/Details.cshtml</li></ul><p>除了一個一個加資料夾<br>也可以再 View 方法右鍵新增 View，按下新增檢視，</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/VZjdYsl.png data-srcset="https://i.imgur.com/VZjdYsl.png, https://i.imgur.com/VZjdYsl.png 1.5x, https://i.imgur.com/VZjdYsl.png 2x" data-sizes=auto alt=https://i.imgur.com/VZjdYsl.png title=https://i.imgur.com/VZjdYsl.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/5zzv4k1.png data-srcset="https://i.imgur.com/5zzv4k1.png, https://i.imgur.com/5zzv4k1.png 1.5x, https://i.imgur.com/5zzv4k1.png 2x" data-sizes=auto alt=https://i.imgur.com/5zzv4k1.png title=https://i.imgur.com/5zzv4k1.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/GYaMvp7.png data-srcset="https://i.imgur.com/GYaMvp7.png, https://i.imgur.com/GYaMvp7.png 1.5x, https://i.imgur.com/GYaMvp7.png 2x" data-sizes=auto alt=https://i.imgur.com/GYaMvp7.png title=https://i.imgur.com/GYaMvp7.png></p><p>Views/Home/Details(View)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@{
</span></span><span class=line><span class=cl>    ViewData[&#34;Title&#34;] = &#34;Details&#34;;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>h1</span><span class=p>&gt;</span>Details<span class=p>&lt;/</span><span class=nt>h1</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=net-core-5-建立檢視失敗可以參考參考>.Net Core 5 建立檢視失敗可以參考(參考)</h3><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/nWNKczr.png data-srcset="https://i.imgur.com/nWNKczr.png, https://i.imgur.com/nWNKczr.png 1.5x, https://i.imgur.com/nWNKczr.png 2x" data-sizes=auto alt=https://i.imgur.com/nWNKczr.png title=https://i.imgur.com/nWNKczr.png></p><p><a href=https://stackoverflow.com/questions/70616562/how-to-create-mvc5-web-project-in-visual-studio-2022 target=_blank rel="noopener noreffer">c# - How to create MVC5 web project in visual studio 2022 - Stack Overflow</a></p><h2 id=自訂義-view-發現>自訂義 View 發現</h2><p>可以自訂View頁面，有下面三種方式。</p><ol><li><code>View("Test")</code> => /Views/Home/Test</li><li><code>View("~/Test/xxx.cshtml");</code> => 絕對路徑</li><li><code>View("../../xxx");</code> => 相對路徑，不用加 cshtml</li></ol><p>推薦使用<code>絕對路徑</code>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>public</span> <span class=k>virtual</span> <span class=n>ViewResult</span> <span class=n>View</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>virtual</span> <span class=n>ViewResult</span> <span class=n>View</span><span class=p>(</span><span class=kt>string</span> <span class=n>viewName</span><span class=p>,</span> <span class=kt>object</span> <span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>virtual</span> <span class=n>ViewResult</span> <span class=n>View</span><span class=p>(</span><span class=kt>object</span> <span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>virtual</span> <span class=n>ViewResult</span> <span class=n>View</span><span class=p>(</span><span class=kt>string</span> <span class=n>viewName</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=controller-傳遞資料到-view>Controller 傳遞資料到 View</h2><ul><li>使用 ViewData</li><li>使用 ViewBag</li><li>強型別View</li></ul><h3 id=viewdata>ViewData</h3><ul><li>是弱型別的字典(Dictonary)物件。</li><li>使用 string 型別的Key值，儲存和查詢 ViewData 字典中的資料</li><li>執行時動態解析</li><li>沒有智能感知，編譯時也沒有型別檢查</li></ul><p>Controllers\HomeController.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Dog</span> <span class=n>dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>ViewData</span><span class=p>[</span><span class=s>&#34;PageTitle&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;Dog Details&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>ViewData</span><span class=p>[</span><span class=s>&#34;Dog&#34;</span><span class=p>]</span> <span class=p>=</span> <span class=n>dog</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>dog</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Views\Home\Details.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@using WebApplication3.Models
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>@ViewData[&#34;PageTitle&#34;]<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span>@ViewData[&#34;PageTitle&#34;]<span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    @{
</span></span><span class=line><span class=cl>        var dog = ViewData[&#34;Dog&#34;] as Dog;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        名稱：@dog.Name
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        地址：@dog.Address
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/LyfKalf.png data-srcset="https://i.imgur.com/LyfKalf.png, https://i.imgur.com/LyfKalf.png 1.5x, https://i.imgur.com/LyfKalf.png 2x" data-sizes=auto alt=https://i.imgur.com/LyfKalf.png title=https://i.imgur.com/LyfKalf.png></p><h3 id=viewbag>ViewBag</h3><ul><li>ViewBag是ViewData的包裝器</li><li>它們都建立了一個弱型別的View</li><li>ViewData使用字串Key來儲存和查詢資料</li><li>ViewBag使用動態屬性來儲存和查詢資料</li><li>均是在運釆時動態解析</li><li>均不是供編譯時型別檢查，沒有智能提示。</li><li>首選方法是使用強類別模型物件，將資料從控制器傳遞到View。</li></ul><p>Views\Home\Details.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Dog</span> <span class=n>dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>ViewBag</span><span class=p>.</span><span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;Dog Details&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>ViewBag</span><span class=p>.</span><span class=n>Dog</span> <span class=p>=</span> <span class=n>dog</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>dog</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Views\Home\Details.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@using WebApplication3.Models
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>@ViewBag.PageTitle<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>h3</span><span class=p>&gt;</span>@ViewBag.PageTitle<span class=p>&lt;/</span><span class=nt>h3</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        名稱：@ViewBag.Dog.Name
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        地址：@ViewBag.Dog.Address
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/B6aoL9H.png data-srcset="https://i.imgur.com/B6aoL9H.png, https://i.imgur.com/B6aoL9H.png 1.5x, https://i.imgur.com/B6aoL9H.png 2x" data-sizes=auto alt=https://i.imgur.com/B6aoL9H.png title=https://i.imgur.com/B6aoL9H.png></p><h3 id=強型別view>強型別View</h3><ul><li>使用<code>@model</code>指另指定型別</li><li>使用<code>@Model</code>抓出物件屬性</li><li>強行別類型View提供編譯時類型檢查和智能提示</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Dog</span> <span class=n>dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>dog</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@model WebApplication3.Models.Dog
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        名稱：@Model.Name
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        地址：@Model.Address
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    @Model
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/5NgqOU1.png data-srcset="https://i.imgur.com/5NgqOU1.png, https://i.imgur.com/5NgqOU1.png 1.5x, https://i.imgur.com/5NgqOU1.png 2x" data-sizes=auto alt=https://i.imgur.com/5NgqOU1.png title=https://i.imgur.com/5NgqOU1.png></p><h2 id=viewmodel-視圖模型>ViewModel 視圖模型</h2><p>模型物件無法滿足視圖所需的所有資料時，就需要使用 ViewModel了。</p><p>建立<code>ViewModels</code>資料夾，檔案以 <code>*ViewModel.cs</code>做結尾`。</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/L6JE6kb.png data-srcset="https://i.imgur.com/L6JE6kb.png, https://i.imgur.com/L6JE6kb.png 1.5x, https://i.imgur.com/L6JE6kb.png 2x" data-sizes=auto alt=https://i.imgur.com/L6JE6kb.png title=https://i.imgur.com/L6JE6kb.png></p><p>HomeDetailsViewModel.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.ViewModels</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>HomeDetailsViewModel</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=kt>string</span> <span class=n>PageTitle</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>Dog</span> <span class=n>Dog</span> <span class=p>{</span> <span class=k>get</span><span class=p>;</span> <span class=k>set</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>WebApplication3\WebApplication3\Controllers\HomeController.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>HomeDetailsViewModel</span> <span class=n>homeDetailsViewModel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HomeDetailsViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=m>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;狗的詳情&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>homeDetailsViewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>WebApplication3\WebApplication3\Views\Home\Details.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@model WebApplication3.ViewModels.HomeDetailsViewModel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>@Model.PageTitle<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        名稱：@Model.Dog.Name
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        地址：@Model.Dog.Address
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    @Model
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/w6OPQxc.png data-srcset="https://i.imgur.com/w6OPQxc.png, https://i.imgur.com/w6OPQxc.png 1.5x, https://i.imgur.com/w6OPQxc.png 2x" data-sizes=auto alt=https://i.imgur.com/w6OPQxc.png title=https://i.imgur.com/w6OPQxc.png></p><p>總結小記:</p><ol><li>新增 ViewModel 物件，設定好屬性。</li><li>Controler新增ViewModel，把這個物件傳到 View上面</li><li>View 使用 ViewModel物件。</li></ol><h2 id=實現-list-視圖>實現 List 視圖</h2><p>WebApplication3\WebApplication3\Models\IDogRepository.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Collections.Generic</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Models</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>interface</span> <span class=nc>IDogRepository</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>Dog</span> <span class=n>getDog</span><span class=p>(</span><span class=kt>int</span> <span class=n>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// 新增 GetAllDogs</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IEnumerable</span><span class=p>&lt;</span><span class=n>Dog</span><span class=p>&gt;</span> <span class=n>GetAllDogs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>WebApplication3\WebApplication3\Models\MockDogRepository.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Collections.Generic</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Linq</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Models</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>MockDogRepository</span> <span class=p>:</span> <span class=n>IDogRepository</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>Dog</span><span class=p>&gt;</span> <span class=n>_dogList</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>MockDogRepository</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogList</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=n>Dog</span><span class=p>&gt;()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Dog</span><span class=p>(){</span><span class=n>Id</span><span class=p>=</span><span class=m>1</span><span class=p>,</span><span class=n>Name</span> <span class=p>=</span><span class=s>&#34;dog1&#34;</span><span class=p>,</span><span class=n>Address</span><span class=p>=</span><span class=s>&#34;tw&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Dog</span><span class=p>(){</span><span class=n>Id</span><span class=p>=</span><span class=m>2</span><span class=p>,</span><span class=n>Name</span> <span class=p>=</span><span class=s>&#34;dog2&#34;</span><span class=p>,</span><span class=n>Address</span><span class=p>=</span><span class=s>&#34;tw&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>Dog</span><span class=p>(){</span><span class=n>Id</span><span class=p>=</span><span class=m>3</span><span class=p>,</span><span class=n>Name</span> <span class=p>=</span><span class=s>&#34;dog2&#34;</span><span class=p>,</span><span class=n>Address</span><span class=p>=</span><span class=s>&#34;tw&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 新增這個方法</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IEnumerable</span><span class=p>&lt;</span><span class=n>Dog</span><span class=p>&gt;</span> <span class=n>GetAllDogs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>_dogList</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>Dog</span> <span class=n>getDog</span><span class=p>(</span><span class=kt>int</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>_dogList</span><span class=p>.</span><span class=n>FirstOrDefault</span><span class=p>(</span><span class=n>a</span> <span class=p>=&gt;</span> <span class=n>a</span><span class=p>.</span><span class=n>Id</span> <span class=p>==</span> <span class=n>id</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>WebApplication3\WebApplication3\Controllers\HomeController.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>model</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>GetAllDogs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>WebApplication3\WebApplication3\Views\Home\Index.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@model IEnumerable<span class=p>&lt;</span><span class=nt>WebApplication3.Models.Dog</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>狗的清單<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>table</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span>序號<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span>名稱<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span>地址<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        @foreach (var dog in Model) 
</span></span><span class=line><span class=cl>       {
</span></span><span class=line><span class=cl>           <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>               <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                   @dog.Id
</span></span><span class=line><span class=cl>               <span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>               <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                   @dog.Name
</span></span><span class=line><span class=cl>               <span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>               <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                   @dog.Address
</span></span><span class=line><span class=cl>               <span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>           <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>       }
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=net-core-mvc-部局視圖>.NET Core MVC 部局視圖</h2><p>讓web應用程式中讓所有的視圖保持外觀一致性。布局檔案默認為<code>_Layout.cshtml</code>。通常放在<code>(Views/Pages)/Shared</code>資料夾。</p><p>在View或Page 建立 <code>Shared</code> 資料夾。<br>建立 <code>Shared/_Layout.cshtml</code>。</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/DZ5zy2x.png data-srcset="https://i.imgur.com/DZ5zy2x.png, https://i.imgur.com/DZ5zy2x.png 1.5x, https://i.imgur.com/DZ5zy2x.png 2x" data-sizes=auto alt=https://i.imgur.com/DZ5zy2x.png title=https://i.imgur.com/DZ5zy2x.png></p><p>Shared/_Layout.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>charset</span><span class=o>=</span><span class=s>&#34;utf-8&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>@ViewBag.Title<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    @RenderBody()
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>F:\source\repos\WebApplication3\WebApplication3\Views\Home\Details.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@model WebApplication3.ViewModels.HomeDetailsViewModel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>@{
</span></span><span class=line><span class=cl>    Layout = &#34;~/Views/Shared/_Layout.cshtml&#34;;
</span></span><span class=line><span class=cl>    ViewBag.Title = @Model.PageTitle;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>    &lt;div&gt;
</span></span><span class=line><span class=cl>        名稱：@Model.Dog.Name
</span></span><span class=line><span class=cl>    &lt;/div&gt;
</span></span><span class=line><span class=cl>    &lt;div&gt;
</span></span><span class=line><span class=cl>        地址：@Model.Dog.Address
</span></span><span class=line><span class=cl>    &lt;/div&gt;
</span></span><span class=line><span class=cl>    @Model
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/xxwOoym.png data-srcset="https://i.imgur.com/xxwOoym.png, https://i.imgur.com/xxwOoym.png 1.5x, https://i.imgur.com/xxwOoym.png 2x" data-sizes=auto alt=https://i.imgur.com/xxwOoym.png title=https://i.imgur.com/xxwOoym.png></p><p>WebApplication3\WebApplication3\Views\Home\Index.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@model IEnumerable<span class=p>&lt;</span><span class=nt>WebApplication3.Models.Dog</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>@{
</span></span><span class=line><span class=cl>    Layout = &#34;~/Views/Shared/_Layout.cshtml&#34;;
</span></span><span class=line><span class=cl>    ViewBag.Title = &#34;狗的清單&#34;;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>table</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span>序號<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span>名稱<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>th</span><span class=p>&gt;</span>地址<span class=p>&lt;/</span><span class=nt>th</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        @foreach (var dog in Model) 
</span></span><span class=line><span class=cl>       {
</span></span><span class=line><span class=cl>           <span class=p>&lt;</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>               <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                   @dog.Id
</span></span><span class=line><span class=cl>               <span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>               <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                   @dog.Name
</span></span><span class=line><span class=cl>               <span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>               <span class=p>&lt;</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                   @dog.Address
</span></span><span class=line><span class=cl>               <span class=p>&lt;/</span><span class=nt>td</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>           <span class=p>&lt;/</span><span class=nt>tr</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>       }
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>table</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/dQkcjhF.png data-srcset="https://i.imgur.com/dQkcjhF.png, https://i.imgur.com/dQkcjhF.png 1.5x, https://i.imgur.com/dQkcjhF.png 2x" data-sizes=auto alt=https://i.imgur.com/dQkcjhF.png title=https://i.imgur.com/dQkcjhF.png></p><h2 id=布局頁面的結點sections>布局頁面的結點(Sections)</h2><p>提了一種方法讓某些頁面元素放在一起。可以強制性使用或者可選擇性使用。使用<code>RenderSection()</code>來呼叫</p><p>WebApplication3\WebApplication3\Views\Shared_Layout.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE html&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;viewport&#34;</span> <span class=na>content</span><span class=o>=</span><span class=s>&#34;width=device-width&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>title</span><span class=p>&gt;</span>@ViewBag.Title<span class=p>&lt;/</span><span class=nt>title</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        @RenderBody()
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    @RenderSection(&#34;Scripts&#34;,required: false)
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>中間那一段<code>@RenderSection("Scripts",required: false)</code>可以改寫</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    @if (IsSectionDefined(&#34;Scripts&#34;))
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>        @RenderSection(&#34;Scripts&#34;,required: false)
</span></span><span class=line><span class=cl>    }
</span></span></code></pre></td></tr></table></div></div><p>WebApplication3\WebApplication3\Views\Home\Details.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@model WebApplication3.ViewModels.HomeDetailsViewModel
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>@{
</span></span><span class=line><span class=cl>    Layout = &#34;~/Views/Shared/_Layout.cshtml&#34;;
</span></span><span class=line><span class=cl>    ViewBag.Title = @Model.PageTitle;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        名稱：@Model.Dog.Name
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        地址：@Model.Dog.Address
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>div</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    @Model
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>@section Scripts{
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;~/js/site.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>重點</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>@section Scripts{
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;~/js/site.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>結果會顯示<br><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/7B2vn4Q.png data-srcset="https://i.imgur.com/7B2vn4Q.png, https://i.imgur.com/7B2vn4Q.png 1.5x, https://i.imgur.com/7B2vn4Q.png 2x" data-sizes=auto alt=https://i.imgur.com/7B2vn4Q.png title=https://i.imgur.com/7B2vn4Q.png></p><h2 id=_viewstartcshtml>_ViewStart.cshtml</h2><p><code>_ViewStart.cshtml</code>程式碼會先在單個是途中先執行程式碼。減少了程式碼重複性。</p><p>新增時候選擇<br><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/Z5Y5pi4.png data-srcset="https://i.imgur.com/Z5Y5pi4.png, https://i.imgur.com/Z5Y5pi4.png 1.5x, https://i.imgur.com/Z5Y5pi4.png 2x" data-sizes=auto alt=https://i.imgur.com/Z5Y5pi4.png title=https://i.imgur.com/Z5Y5pi4.png></p><p>建立在View資料夾</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/5tqHMAL.png data-srcset="https://i.imgur.com/5tqHMAL.png, https://i.imgur.com/5tqHMAL.png 1.5x, https://i.imgur.com/5tqHMAL.png 2x" data-sizes=auto alt=https://i.imgur.com/5tqHMAL.png title=https://i.imgur.com/5tqHMAL.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@{
</span></span><span class=line><span class=cl>    Layout = &#34;~/Views/Shared/_Layout.cshtml&#34;;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>其他View屬性就不須指定<code>_Layout</code>。<br>也可以簡略寫成如下</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>@{
</span></span><span class=line><span class=cl>    Layout = &#34;_Layout2&#34;;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>執行_ViewStart.cshtml順序如下圖，裡面的Home資料夾，依序先執行1，在執行2，依序後蓋前設定。</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/ftaRviN.png data-srcset="https://i.imgur.com/ftaRviN.png, https://i.imgur.com/ftaRviN.png 1.5x, https://i.imgur.com/ftaRviN.png 2x" data-sizes=auto alt=https://i.imgur.com/ftaRviN.png title=https://i.imgur.com/ftaRviN.png></p><h2 id=_viewimportcshtml>_ViewImport.cshtml</h2><p>上面我們寫的專案需要寫很長文字去讀取物件出來，如<code>@model WebApplication3.ViewModels.HomeDetailsViewModel</code>，<code>_ViewImport.cshtml</code>就是很好解決這個問題。</p><p>新增檔案建立到Views資料夾，參考下圖<br><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/sbsThTd.png data-srcset="https://i.imgur.com/sbsThTd.png, https://i.imgur.com/sbsThTd.png 1.5x, https://i.imgur.com/sbsThTd.png 2x" data-sizes=auto alt=https://i.imgur.com/sbsThTd.png title=https://i.imgur.com/sbsThTd.png></p><p>WebApplication3\WebApplication3\Views_ViewImports.cshtml</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>@using</span> <span class=n>WebApplication3</span><span class=p>.</span><span class=n>Models</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>我們在原有的View就可以不用寫前面的 namespace</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/exAluJQ.png data-srcset="https://i.imgur.com/exAluJQ.png, https://i.imgur.com/exAluJQ.png 1.5x, https://i.imgur.com/exAluJQ.png 2x" data-sizes=auto alt=https://i.imgur.com/exAluJQ.png title=https://i.imgur.com/exAluJQ.png></p><p>簡單整理:</p><ul><li>需使用<code>@using</code>指令包含公共命局空間</li><li>_ViewImports 文件還支持以下指令<ul><li>@addTagHelper</li><li>@removeTagHelper</li><li>@tagHelperPrefix</li><li>@model</li><li>@inherits</li><li>@inject</li></ul></li><li>ViewImports 文件支持分層讀取，這邊跟<code>_ViewStart.cshtml</code>一樣。1先讀2後讀，後蓋前設定。</li></ul><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/fysGKbW.png data-srcset="https://i.imgur.com/fysGKbW.png, https://i.imgur.com/fysGKbW.png 1.5x, https://i.imgur.com/fysGKbW.png 2x" data-sizes=auto alt=https://i.imgur.com/fysGKbW.png title=https://i.imgur.com/fysGKbW.png></p><h2 id=路由route>路由(Route)</h2><p>預設路由</p><p>WebApplication3\WebApplication3\Startup.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=k>void</span> <span class=n>Configure</span><span class=p>(</span><span class=n>IApplicationBuilder</span> <span class=n>app</span><span class=p>,</span> <span class=n>IWebHostEnvironment</span> <span class=n>env</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=n>app</span><span class=p>.</span><span class=n>UseMvcWithDefaultRoute</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>我們這邊可以看到使用 <code>app.UseMvcWithDefaultRoute()</code> 做預設路由。從下面註解可以看到預設規則。<br><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/z4Cngz2.png data-srcset="https://i.imgur.com/z4Cngz2.png, https://i.imgur.com/z4Cngz2.png 1.5x, https://i.imgur.com/z4Cngz2.png 2x" data-sizes=auto alt=https://i.imgur.com/z4Cngz2.png title=https://i.imgur.com/z4Cngz2.png></p><p>這邊使用原本需要手動建立 router 規則。參考如下。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>            <span class=c1>//app.UseMvcWithDefaultRoute();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseMvc</span><span class=p>(</span><span class=n>routes</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>routes</span><span class=p>.</span><span class=n>MapRoute</span><span class=p>(</span><span class=s>&#34;default&#34;</span><span class=p>,</span> <span class=s>&#34;{controller=Home}/{action=Index}/{id?}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><p>預設 Router 規則參照如下。<br><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/Jn0WB4M.png data-srcset="https://i.imgur.com/Jn0WB4M.png, https://i.imgur.com/Jn0WB4M.png 1.5x, https://i.imgur.com/Jn0WB4M.png 2x" data-sizes=auto alt=https://i.imgur.com/Jn0WB4M.png title=https://i.imgur.com/Jn0WB4M.png></p><p>下面直接操作看看。</p><p>修改 <code>HomeController.cs</code> details 補上傳入 id 參數</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>(</span><span class=kt>int</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>HomeDetailsViewModel</span> <span class=n>homeDetailsViewModel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HomeDetailsViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=n>id</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;狗的詳情&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>homeDetailsViewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>WebApplication3\WebApplication3\Controllers\HomeController.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Controllers</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>HomeController</span> <span class=p>:</span> <span class=n>Controller</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=k>readonly</span> <span class=n>IDogRepository</span> <span class=n>_dogRepostory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>HomeController</span><span class=p>(</span><span class=n>IDogRepository</span> <span class=n>dogRepository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogRepostory</span> <span class=p>=</span> <span class=n>dogRepository</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>model</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>GetAllDogs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>(</span><span class=kt>int</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>HomeDetailsViewModel</span> <span class=n>homeDetailsViewModel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HomeDetailsViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=n>id</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;狗的詳情&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>homeDetailsViewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=屬性路由>屬性路由</h2><p>使用屬性路由，我們使用<code>Route()</code>屬性定義路由。<br>屬性路由通常定義在<code>Controller</code>或<code>Controller的方法</code>上面<br>強制上層路由呼叫以<code>/</code>和<code>~/</code>來做設定。</p><p>這邊我們在<code>Startup.cs</code>先取消預設路由做測試。<br>這邊注意，我.NET Core 5 版本預設有 Page 資料夾，這邊建議先重新命名資料夾名稱，這樣就不會跟你的 Router 衝突到。</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/JvFOEIR.png data-srcset="https://i.imgur.com/JvFOEIR.png, https://i.imgur.com/JvFOEIR.png 1.5x, https://i.imgur.com/JvFOEIR.png 2x" data-sizes=auto alt=https://i.imgur.com/JvFOEIR.png title=https://i.imgur.com/JvFOEIR.png></p><p>Startup.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseMvc</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>WebApplication3\WebApplication3\Controllers\HomeController.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>        [Route(&#34;&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;Home&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;Home/Index&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>model</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>GetAllDogs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>查看結果:</p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/eEk9CuO.png data-srcset="https://i.imgur.com/eEk9CuO.png, https://i.imgur.com/eEk9CuO.png 1.5x, https://i.imgur.com/eEk9CuO.png 2x" data-sizes=auto alt=https://i.imgur.com/eEk9CuO.png title=https://i.imgur.com/eEk9CuO.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/ssQ4fIv.png data-srcset="https://i.imgur.com/ssQ4fIv.png, https://i.imgur.com/ssQ4fIv.png 1.5x, https://i.imgur.com/ssQ4fIv.png 2x" data-sizes=auto alt=https://i.imgur.com/ssQ4fIv.png title=https://i.imgur.com/ssQ4fIv.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/wl5umJM.png data-srcset="https://i.imgur.com/wl5umJM.png, https://i.imgur.com/wl5umJM.png 1.5x, https://i.imgur.com/wl5umJM.png 2x" data-sizes=auto alt=https://i.imgur.com/wl5umJM.png title=https://i.imgur.com/wl5umJM.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>        [Route(&#34;Home/Details/{id?}&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>(</span><span class=kt>int</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>HomeDetailsViewModel</span> <span class=n>homeDetailsViewModel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HomeDetailsViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=n>id</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;狗的詳情&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>homeDetailsViewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/9CNeRcR.png data-srcset="https://i.imgur.com/9CNeRcR.png, https://i.imgur.com/9CNeRcR.png 1.5x, https://i.imgur.com/9CNeRcR.png 2x" data-sizes=auto alt=https://i.imgur.com/9CNeRcR.png title=https://i.imgur.com/9CNeRcR.png></p><p><code>id</code>空值會報錯！<br><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/5briUL4.png data-srcset="https://i.imgur.com/5briUL4.png, https://i.imgur.com/5briUL4.png 1.5x, https://i.imgur.com/5briUL4.png 2x" data-sizes=auto alt=https://i.imgur.com/5briUL4.png title=https://i.imgur.com/5briUL4.png></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>        [Route(&#34;Home/Details/{id?}&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>(</span><span class=kt>int?</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>HomeDetailsViewModel</span> <span class=n>homeDetailsViewModel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HomeDetailsViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=n>id</span><span class=p>??</span><span class=m>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;狗的詳情&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>homeDetailsViewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/qLiO5HB.png data-srcset="https://i.imgur.com/qLiO5HB.png, https://i.imgur.com/qLiO5HB.png 1.5x, https://i.imgur.com/qLiO5HB.png 2x" data-sizes=auto alt=https://i.imgur.com/qLiO5HB.png title=https://i.imgur.com/qLiO5HB.png></p><p>解決問題。</p><h3 id=controller-跟-router-命名不一樣>Controller 跟 Router 命名不一樣</h3><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/9A4SVgX.png data-srcset="https://i.imgur.com/9A4SVgX.png, https://i.imgur.com/9A4SVgX.png 1.5x, https://i.imgur.com/9A4SVgX.png 2x" data-sizes=auto alt=https://i.imgur.com/9A4SVgX.png title=https://i.imgur.com/9A4SVgX.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/LM3bEp3.png data-srcset="https://i.imgur.com/LM3bEp3.png, https://i.imgur.com/LM3bEp3.png 1.5x, https://i.imgur.com/LM3bEp3.png 2x" data-sizes=auto alt=https://i.imgur.com/LM3bEp3.png title=https://i.imgur.com/LM3bEp3.png></p><p>這邊看這兩張圖，發現他找View會找不到。</p><p>這邊就需要決斷路徑指定View，上面View有提到。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=na>        [Route(&#34;&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;Home&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;Home/Index&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>model</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>GetAllDogs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=s>&#34;~/Views/Home/Index.cshtml&#34;</span><span class=p>,</span><span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/qVi5e5D.png data-srcset="https://i.imgur.com/qVi5e5D.png, https://i.imgur.com/qVi5e5D.png 1.5x, https://i.imgur.com/qVi5e5D.png 2x" data-sizes=auto alt=https://i.imgur.com/qVi5e5D.png title=https://i.imgur.com/qVi5e5D.png></p><h2 id=route-放置-controller-上面>Route 放置 Controller 上面</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Controllers</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=na>    [Route(&#34;Home&#34;)]</span>
</span></span><span class=line><span class=cl>    <span class=k>public</span> <span class=k>class</span> <span class=nc>HomeController</span> <span class=p>:</span> <span class=n>Controller</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=k>readonly</span> <span class=n>IDogRepository</span> <span class=n>_dogRepostory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>HomeController</span><span class=p>(</span><span class=n>IDogRepository</span> <span class=n>dogRepository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogRepostory</span> <span class=p>=</span> <span class=n>dogRepository</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>        [Route(&#34;~/&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;Index&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>model</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>GetAllDogs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>        [Route(&#34;Details/{id?}&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>(</span><span class=kt>int?</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>HomeDetailsViewModel</span> <span class=n>homeDetailsViewModel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HomeDetailsViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=n>id</span><span class=p>??</span><span class=m>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;狗的詳情&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>homeDetailsViewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/lpLotoS.png data-srcset="https://i.imgur.com/lpLotoS.png, https://i.imgur.com/lpLotoS.png 1.5x, https://i.imgur.com/lpLotoS.png 2x" data-sizes=auto alt=https://i.imgur.com/lpLotoS.png title=https://i.imgur.com/lpLotoS.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/3yTa3yw.png data-srcset="https://i.imgur.com/3yTa3yw.png, https://i.imgur.com/3yTa3yw.png 1.5x, https://i.imgur.com/3yTa3yw.png 2x" data-sizes=auto alt=https://i.imgur.com/3yTa3yw.png title=https://i.imgur.com/3yTa3yw.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/y5zuEFI.png data-srcset="https://i.imgur.com/y5zuEFI.png, https://i.imgur.com/y5zuEFI.png 1.5x, https://i.imgur.com/y5zuEFI.png 2x" data-sizes=auto alt=https://i.imgur.com/y5zuEFI.png title=https://i.imgur.com/y5zuEFI.png></p><p><img class=lazyload src=/blog/svg/loading.min.svg data-src=https://i.imgur.com/jJ5b152.png data-srcset="https://i.imgur.com/jJ5b152.png, https://i.imgur.com/jJ5b152.png 1.5x, https://i.imgur.com/jJ5b152.png 2x" data-sizes=auto alt=https://i.imgur.com/jJ5b152.png title=https://i.imgur.com/jJ5b152.png></p><h3 id=在自動調整方法>在自動調整方法</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Controllers</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=na>    [Route(&#34;[controller]</span><span class=s>&#34;)]
</span></span></span><span class=line><span class=cl><span class=s></span>    <span class=k>public</span> <span class=k>class</span> <span class=nc>HomeController</span> <span class=p>:</span> <span class=n>Controller</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=k>readonly</span> <span class=n>IDogRepository</span> <span class=n>_dogRepostory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>HomeController</span><span class=p>(</span><span class=n>IDogRepository</span> <span class=n>dogRepository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogRepostory</span> <span class=p>=</span> <span class=n>dogRepository</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>        [Route(&#34;~/&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;[action]</span><span class=s>&#34;)]
</span></span></span><span class=line><span class=cl><span class=s></span>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>model</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>GetAllDogs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>        [Route(&#34;[action]</span><span class=p>/{</span><span class=n>id</span><span class=p>?}</span><span class=s>&#34;)]
</span></span></span><span class=line><span class=cl><span class=s></span>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>(</span><span class=kt>int?</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>HomeDetailsViewModel</span> <span class=n>homeDetailsViewModel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HomeDetailsViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=n>id</span><span class=p>??</span><span class=m>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;狗的詳情&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>homeDetailsViewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>在更精簡方法</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.AspNetCore.Mvc</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.Models</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>WebApplication3.ViewModels</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>namespace</span> <span class=nn>WebApplication3.Controllers</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl><span class=na>    [Route(&#34;[controller]</span><span class=p>/[</span><span class=n>action</span><span class=p>]</span><span class=s>&#34;)]
</span></span></span><span class=line><span class=cl><span class=s></span>    <span class=k>public</span> <span class=k>class</span> <span class=nc>HomeController</span> <span class=p>:</span> <span class=n>Controller</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>private</span> <span class=k>readonly</span> <span class=n>IDogRepository</span> <span class=n>_dogRepostory</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>HomeController</span><span class=p>(</span><span class=n>IDogRepository</span> <span class=n>dogRepository</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>_dogRepostory</span> <span class=p>=</span> <span class=n>dogRepository</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>        [Route(&#34;~/&#34;)]</span>
</span></span><span class=line><span class=cl><span class=na>        [Route(&#34;~/Home&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Index</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>var</span> <span class=n>model</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>GetAllDogs</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>model</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>        [Route(&#34;{id?}&#34;)]</span>
</span></span><span class=line><span class=cl>        <span class=k>public</span> <span class=n>IActionResult</span> <span class=n>Details</span><span class=p>(</span><span class=kt>int?</span> <span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>HomeDetailsViewModel</span> <span class=n>homeDetailsViewModel</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HomeDetailsViewModel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>Dog</span> <span class=p>=</span> <span class=n>_dogRepostory</span><span class=p>.</span><span class=n>getDog</span><span class=p>(</span><span class=n>id</span><span class=p>??</span><span class=m>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                <span class=n>PageTitle</span> <span class=p>=</span> <span class=s>&#34;狗的詳情&#34;</span>
</span></span><span class=line><span class=cl>            <span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>View</span><span class=p>(</span><span class=n>homeDetailsViewModel</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=實戰中還是用>實戰中還是用&mldr;</h3><p>Startup.cs</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl>            <span class=n>app</span><span class=p>.</span><span class=n>UseMvc</span><span class=p>(</span><span class=n>routes</span> <span class=p>=&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>routes</span><span class=p>.</span><span class=n>MapRoute</span><span class=p>(</span><span class=s>&#34;default&#34;</span><span class=p>,</span> <span class=s>&#34;{controller=Home}/{action=Index}/{id?}&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=總結>總結</h2><p>仔細再回來看這篇，這邊已經把剛入手要會的東西。再有相關程式經驗學習 Net Core 也是可以很快上手，再搭配 Visual Studio 智慧提示，你可以很快撰寫程式碼，也可以知道程式哪裡錯。</p><p>Net Core的 View 真的讓我滿經驗，在我學 Laravel 和 Spring Boot 的 View 時候，編譯器無法判別哪邊有寫錯誤(也可能我不會設定🤣)，Visual Studio 就可以做到。在寫 View 時候有些沒有判斷到都可以早點發現。後面我工作是做純後端，所以平常是不寫 View，但我會建議去了解它怎麼使用。</p><div align=center><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1439458814178865" crossorigin=anonymous></script>
<ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-1439458814178865 data-ad-slot=2236653478></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-12-01</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://malagege.github.io/blog/posts/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98/ data-title="NET Core MVC 入門操作筆記" data-hashtags="di,mvc,net core,api,controller,view,repository"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://malagege.github.io/blog/posts/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98/ data-hashtag=di><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://malagege.github.io/blog/posts/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98/ data-title="NET Core MVC 入門操作筆記"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://malagege.github.io/blog/posts/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98/ data-title="NET Core MVC 入門操作筆記"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://malagege.github.io/blog/posts/NET-Core-MVC-%E5%85%A5%E9%96%80%E6%93%8D%E4%BD%9C%E7%AD%86%E8%A8%98/ data-title="NET Core MVC 入門操作筆記" data-image=https://user-images.githubusercontent.com/6058558/205041867-93ffe0d5-60e8-4d96-b2dd-40328554913a.png><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/blog/tags/di/>di</a>,&nbsp;<a href=/blog/tags/mvc/>mvc</a>,&nbsp;<a href=/blog/tags/net-core/>net core</a>,&nbsp;<a href=/blog/tags/api/>api</a>,&nbsp;<a href=/blog/tags/controller/>controller</a>,&nbsp;<a href=/blog/tags/View/>View</a>,&nbsp;<a href=/blog/tags/repository/>repository</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/blog/>Home</a></span></section></div><div class=post-nav><a href=/blog/posts/Net-Core-%E5%89%B5%E5%BB%BA%E5%B0%88%E6%A1%88/ class=prev rel=prev title="第一次使用 Visual Studio 2022 創建 Net Core 專案和技術名詞小記"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>第一次使用 Visual Studio 2022 創建 Net Core 專案和技術名詞小記</a>
<a href=/blog/posts/Net-Core-Image-Helper-%E8%A7%A3%E6%B1%BA%E5%9C%96%E7%89%87-img-%E7%B7%A9%E5%AD%98%E5%95%8F%E9%A1%8C/ class=next rel=next title=".Net Core Image Helper 解決圖片 Img 緩存問題">.Net Core Image Helper 解決圖片 Img 緩存問題<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.108.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/blog/ target=_blank>malagege</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><script type=text/javascript src=https://malagege-blog.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},lightgallery:!0,search:{algoliaAppID:"4LYONZIY18",algoliaIndex:"malagege_blog",algoliaSearchKey:"30dc05f673e702e0701b9b40cfa44eac",highlightTag:"em",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"algolia"}}</script><script type=text/javascript src=/blog/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-105195903-2",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-105195903-2" async></script></body></html>